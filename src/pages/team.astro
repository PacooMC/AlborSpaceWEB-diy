---
import Layout from '../layouts/Layout.astro';
import { teamPage, teamMembers } from '../content/team';
import { Mail, MapPin } from 'lucide-astro';

---

<Layout title={`${teamPage.title} - ALBOR SPACE`} description={teamPage.description}>
  <div class="pt-32 pb-24 relative">
    <!-- Background effects -->
    <div class="absolute inset-0 bg-gradient-to-b from-dark-900/90 via-dark-800/50 to-dark-900/90"></div>

    <div class="container-custom relative z-10">
      <!-- Page header -->
      <div class="text-center mb-16 reveal-element">
        <h1 class="heading-lg mb-4 slide-right">{teamPage.title}</h1>
        <p class="text-white/60 max-w-2xl mx-auto">{teamPage.description}</p>
      </div>

      <!-- Team grid with larger, more elegant cards -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mt-16">
        {teamMembers.map((member, index) => (
          <div
            class="team-card group cursor-pointer hover:scale-[1.02] transition-all duration-500"
            data-member={JSON.stringify(member)}
            data-reveal="fade-up"
            data-reveal-delay={index * 100}
          >
            <div class="rounded-xl overflow-hidden h-full bg-dark-800/40 border border-white/5 hover:border-orange-400/20 transition-all duration-300"> {/* Softer hover border */}
              <div class="relative aspect-square overflow-hidden">
                <img
                  src={member.image}
                  alt={member.name}
                  class="w-full h-full object-cover transition-all duration-500 group-hover:scale-110 group-hover:filter group-hover:brightness-110"
                />
                <div class="absolute inset-0 bg-gradient-to-t from-dark-900 via-dark-900/70 to-transparent opacity-60 transition-opacity duration-500 group-hover:opacity-40"></div>
              </div>

              <div class="p-6">
                <h3 class="text-xl font-light mb-2 text-white group-hover:text-orange-400 transition-colors duration-300">{member.name}</h3> {/* Hover name orange-400 */}
                <p class="text-orange-400/90 text-sm tracking-wider uppercase mb-4">{member.role}</p> {/* Role orange-400 */}

                <div class="flex items-center text-white/50 text-sm mb-2">
                  <Mail size={14} class="mr-2 text-orange-400/70" /> {/* Icon orange-400 */}
                  <span class="truncate">{member.email}</span>
                </div>

                <div class="flex items-center text-white/50 text-sm">
                  <MapPin size={14} class="mr-2 text-orange-400/70" /> {/* Icon orange-400 */}
                  <span>Universidad de Málaga</span>
                </div>
              </div>
            </div>
          </div>
        ))}
      </div>

      <!-- Team mission statement section -->
      <div class="mt-24 max-w-4xl mx-auto">
        <div class="glass-card">
          <h2 class="text-3xl font-light mb-6 text-center">Our Mission</h2>
          <p class="text-white/70 mb-6 leading-relaxed">
            At Albor Space, we're dedicated to pushing the boundaries of space communications through innovation,
            research, and technological excellence. Our team combines decades of academic expertise with
            practical industry experience to develop revolutionary solutions for the next generation of
            space exploration and connectivity.
          </p>
          <p class="text-white/70 leading-relaxed">
            Founded by leading experts from the Universidad de Málaga's telecommunications department,
            our team brings together specialists in satellite communications, software-defined radio,
            network optimization, and artificial intelligence to address the most complex challenges in
            non-terrestrial networks.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal for expanded member details -->
  <div id="member-modal" class="fixed inset-0 z-50 flex items-center justify-center px-4 hidden">
    <div class="absolute inset-0 bg-dark-900/98 backdrop-blur-2xl opacity-0 transition-opacity duration-500"></div>
    <div class="relative bg-dark-800/70 rounded-2xl border border-white/10 p-8 max-w-4xl w-full transform scale-95 opacity-0 transition-all duration-500 backdrop-blur-xl shadow-2xl">
      <button id="close-modal" class="absolute top-4 right-4 text-white/50 hover:text-white">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>

      <div class="flex flex-col md:flex-row gap-8">
        <div class="w-full md:w-1/3">
          <div class="rounded-xl overflow-hidden mb-6 ring-1 ring-white/10 shadow-xl">
            <img id="modal-image" src="" alt="" class="w-full aspect-square object-cover">
          </div>

          <!-- Contact info -->
          <div class="space-y-4 p-4 bg-dark-900/50 rounded-xl border border-white/5">
            <h4 class="text-sm uppercase tracking-wider text-white/50 mb-3">Contact Information</h4>

            <a id="modal-email" href="" class="flex items-center text-white/50 hover:text-white group">
              <Mail size={20} class="mr-2 text-orange-400/70" /> {/* Icon orange-400 */}
              <span class="text-sm group-hover:text-orange-400 transition-colors duration-200"></span> {/* Hover text orange-400 */}
            </a>

            <div class="flex items-start text-white/50">
              <MapPin size={20} class="mr-2 shrink-0 text-orange-400/70 mt-0.5" /> {/* Icon orange-400 */}
              <div>
                <p class="text-sm">Departamento de Ingeniería de Comunicaciones</p>
                <p class="text-sm">ETSI Telecomunicación</p>
                <p class="text-sm">Universidad de Málaga</p>
                <p class="text-sm">Campus de Teatinos, 29071 Málaga, Spain</p>
              </div>
            </div>
          </div>
        </div>

        <div class="w-full md:w-2/3">
          <h3 id="modal-name" class="text-2xl font-light mb-2 text-gradient-orange-soft"></h3> {/* Softer gradient */}
          <p id="modal-role" class="text-orange-400/90 text-sm tracking-wider uppercase mb-6"></p> {/* Role orange-400 */}

          <div class="prose prose-invert prose-sm max-w-none">
            <p id="modal-bio" class="text-white/70 leading-relaxed mb-8"></p>

            <!-- Education -->
            <div class="mb-8">
              <h4 class="text-lg font-light mb-4 text-white">Education</h4>
              <ul id="modal-education" class="space-y-2 text-white/60"></ul>
            </div>

            <!-- Expertise -->
            <div class="mb-8">
              <h4 class="text-lg font-light mb-4 text-white">Areas of Expertise</h4>
              <div id="modal-expertise" class="flex flex-wrap gap-2"></div>
            </div>

            <!-- Stats -->
            <div class="grid grid-cols-2 gap-4 text-center">
              <div class="bg-orange-400/5 rounded-lg p-4 border border-orange-400/10"> {/* Background/border orange-400 */}
                <div id="modal-publications" class="text-2xl font-light text-orange-400 mb-2"></div> {/* Text orange-400 */}
                <div class="text-sm text-white/50">Publications</div>
              </div>
              <div class="bg-orange-400/5 rounded-lg p-4 border border-orange-400/10"> {/* Background/border orange-400 */}
                <div id="modal-patents" class="text-2xl font-light text-orange-400 mb-2"></div> {/* Text orange-400 */}
                <div class="text-sm text-white/50">Patents</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</Layout>

<style>
  .team-card {
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  }

  .team-card:hover {
    box-shadow:
      0 20px 40px rgba(0, 0, 0, 0.3),
      0 0 20px theme('colors.orange.400 / 20%'); /* Softer shadow */
  }

  .glass-card {
    background-color: rgba(13, 15, 26, 0.2); /* dark-800 base */
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 0.75rem;
    padding: 2rem;
    transition: all 0.3s ease;
  }

  /* Expertise tag using softer orange */
  .expertise-tag {
    background-color: theme('colors.orange.400 / 15%');
    color: rgba(255, 255, 255, 0.8);
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    border: 1px solid theme('colors.orange.400 / 25%');
    transition: all 0.3s ease;
  }

  .expertise-tag:hover {
    background-color: theme('colors.orange.400 / 20%');
    border-color: theme('colors.orange.400 / 35%');
    transform: translateY(-1px);
  }

  /* Softer text gradient using orange */
  .text-gradient-orange-soft {
    background: linear-gradient(to right, #fff, theme('colors.orange.300'));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const modal = document.getElementById('member-modal');
    const modalOverlay = modal?.querySelector('div');
    const modalContent = modal?.querySelector('div:nth-child(2)');
    const closeButton = document.getElementById('close-modal');

    const modalImage = document.getElementById('modal-image');
    const modalName = document.getElementById('modal-name');
    const modalRole = document.getElementById('modal-role');
    const modalBio = document.getElementById('modal-bio');
    const modalEmail = document.getElementById('modal-email');
    const modalEducation = document.getElementById('modal-education');
    const modalExpertise = document.getElementById('modal-expertise');
    const modalPublications = document.getElementById('modal-publications');
    const modalPatents = document.getElementById('modal-patents');

    function openModal(member) {
      if (modal && modalOverlay && modalContent) {
        modal.classList.remove('hidden');
        setTimeout(() => {
          modalOverlay.classList.add('opacity-100');
          modalContent.classList.remove('scale-95', 'opacity-0');
          modalContent.classList.add('scale-100', 'opacity-100');
        }, 10);

        if (modalImage) {
          modalImage.src = member.image;
          modalImage.alt = member.name;
        }
        if (modalName) modalName.textContent = member.name;
        if (modalRole) modalRole.textContent = member.role;
        if (modalBio) modalBio.textContent = member.bio;

        // Email
        if (modalEmail) {
          modalEmail.href = `mailto:${member.email}`;
          modalEmail.querySelector('span').textContent = member.email;
        }

        // Education
        if (modalEducation) {
          modalEducation.innerHTML = member.education.map(edu =>
            `<li class="flex items-start">
              <span class="w-1.5 h-1.5 rounded-full bg-orange-400/60 mt-2 mr-3"></span> {/* Softer bullet orange */}
              ${edu}
            </li>`
          ).join('');
        }

        // Expertise
        if (modalExpertise) {
          modalExpertise.innerHTML = member.expertise.map(exp =>
            `<span class="expertise-tag">${exp}</span>` // Uses softer orange from style tag
          ).join('');
        }

        // Stats
        if (modalPublications) modalPublications.textContent = member.publications;
        if (modalPatents) modalPatents.textContent = member.patents;
      }
    }

    function closeModal() {
      if (modal && modalOverlay && modalContent) {
        modalOverlay.classList.remove('opacity-100');
        modalContent.classList.remove('scale-100', 'opacity-100');
        modalContent.classList.add('scale-95', 'opacity-0');

        setTimeout(() => {
          modal.classList.add('hidden');
        }, 500);
      }
    }

    // Add click handlers
    document.querySelectorAll('.team-card').forEach(card => {
      card.addEventListener('click', () => {
        const member = JSON.parse(card.getAttribute('data-member') || '{}');
        openModal(member);
      });
    });

    closeButton?.addEventListener('click', closeModal);

    // Close on overlay click
    modalOverlay?.addEventListener('click', (e) => {
      if (e.target === modalOverlay) {
        closeModal();
      }
    });

    // Close on escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeModal();
      }
    });

    // Reveal animations
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const delay = parseInt(entry.target.getAttribute('data-reveal-delay') || '0');
          setTimeout(() => {
            entry.target.classList.add('revealed');
          }, delay);
        }
      });
    }, {
      threshold: 0.1
    });

    document.querySelectorAll('[data-reveal]').forEach(el => {
      observer.observe(el);
    });
  });
</script>
